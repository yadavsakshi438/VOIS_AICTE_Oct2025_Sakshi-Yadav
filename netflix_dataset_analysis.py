# -*- coding: utf-8 -*-
"""Netflix Dataset Analysis.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1DBprHT7Nc10JuVTS_KRD8WKgCRYf51X7
"""

from google.colab import files
uploaded = files.upload()

uploaded.keys()

import pandas as pd

filename = list(uploaded.keys())[0]
df = pd.read_csv(filename)

df.head()

df['Release_Date'] = pd.to_datetime(df['Release_Date'], errors='coerce')

df['Year'] = df['Release_Date'].dt.year

#Movies vs TV Shows Trend
trend = df.groupby(['Year','Category']).size().unstack(fill_value=0)

ax = trend.plot(kind='bar', figsize=(12,6), stacked=True, color=['#FF6F61','#6B5B95'])
ax.set_title("Movies vs TV Shows added per Year", fontsize=14)
ax.set_xlabel("Year")
ax.set_ylabel("Count")
ax.legend(title="Category")
plt.show();

#Popular Top 10 genres
from collections import Counter
genres = df['Type'].dropna().str.split(', ')
all_genres = [g.strip() for sublist in genres for g in sublist]
top_genres = Counter(all_genres).most_common(10)
genre_df = pd.DataFrame(top_genres, columns=['Genre','Count'])

ax = sns.barplot(data=genre_df, x='Count', y='Genre', palette="viridis")
ax.set_title("Top 10 Genres on Netflix", fontsize=14)
plt.show();

#Country Contribution
countries = df['Country'].dropna().str.split(', ')
all_countries = [c.strip() for sublist in countries for c in sublist]
top_countries = Counter(all_countries).most_common(10)
country_df = pd.DataFrame(top_countries, columns=['Country','Count'])

ax = sns.barplot(data=country_df, x='Count', y='Country', palette="mako")
ax.set_title("Top 10 Countries contributing Netflix Content", fontsize=14)
plt.show();

# Strategic Insights
print("ðŸ“Œ Strategic Insights from Netflix Dataset Analysis:\n")

# Movies vs TV Shows balance
more_type = "Movies" if trend['Movie'].sum() > trend['TV Show'].sum() else "TV Shows"
print(f"â€¢ Netflix overall has more **{more_type}** in its catalog.")

# Top genre
print(f"â€¢ The most common genre is **{genre_df.iloc[0,0]}**, showing strong audience preference.")

# Top contributing country
print(f"â€¢ The leading content contributor is **{country_df.iloc[0,0]}**, highlighting its global importance.")

print("\nâœ… These insights can guide Netflix in refining content acquisition & production strategies.")